{"version":3,"sources":["../../src/middleware/index.js"],"names":["app","routes","cookieParser","require","use","req","res","next","cookie","cookies","uuid","undefined","randomNumber","Math","random","toString","substring","length","maxAge","httpOnly"],"mappings":";;;;;;AAAA;;AACA;;AACA;;;;;kBAKe,gBAAa;AAAA,MAAVA,GAAU,QAAVA,GAAU;;AAC3B,MAAIC,SAAS,sBAAb;AACA,MAAIC,eAAeC,QAAQ,eAAR,CAAnB;;AAEDH,MAAII,GAAJ,CAAQF,cAAR;;AAEAF,MAAII,GAAJ,CAAQ,UAAUC,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAChC;AACA,QAAIC,SAASH,IAAII,OAAJ,CAAYC,IAAzB;AACA,QAAIF,WAAWG,SAAf,EACA;AACE;AACA,UAAIC,eAAaC,KAAKC,MAAL,GAAcC,QAAd,EAAjB;AACAH,qBAAaA,aAAaI,SAAb,CAAuB,CAAvB,EAAyBJ,aAAaK,MAAtC,CAAb;AACAX,UAAIE,MAAJ,CAAW,MAAX,EAAkB,eAAlB,EAA4B,EAAEU,QAAQ,MAAV,EAAkBC,UAAU,IAA5B,EAA5B;AACD;AACDZ;AACD,GAXD;;AAaC,SAAON,MAAP;AACA,C","file":"index.js","sourcesContent":["import { Router } from 'express';\nimport { v4 as uuidv4 } from 'uuid';\n/**\n * This middleware is used to set a cookie for every player so as to be able to uniquely recognise every player.\n * This is to tackle the problem that players can change their names in order to cheat.\n * Using cookies with uuid a player can have the same name as the other player and retain their high score.\n */\nexport default ({ app }) => {\n\tlet routes = Router();\n\tvar cookieParser = require('cookie-parser')\n\napp.use(cookieParser());\n\napp.use(function (req, res, next) {\n  // check if player sent cookie\n  var cookie = req.cookies.uuid;\n  if (cookie === undefined)\n  {\n    // cookie doesn't exist, set a new one\n    var randomNumber=Math.random().toString();\n    randomNumber=randomNumber.substring(2,randomNumber.length);\n    res.cookie('uuid',uuidv4(), { maxAge: 900000, httpOnly: true });\n  } \n  next();\n});\n\n\treturn routes;\n}\n"]}